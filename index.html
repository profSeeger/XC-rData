<!DOCTYPE html>
<html>

<head>
    <title>Mapping API's: Leaflet - Layer Control</title>
    <meta name="description" content="Mapping API's: Leaflet - Layer Control" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
    <script src="classes/leaflet.ajax.js"></script>



    <style>
        html,
        body,
        #map {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>

</head>

<body>
    <div id="map"></div>


    <script>
        //Base Layers
        var OSM = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 18
        });


		var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
});

        var nexrad = new L.tileLayer.wms("https://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi", {
            layers: 'nexrad-n0r',
            format: 'image/png',
            transparent: true,
            attribution: "Weather data &copy; 2015 IEM Nexrad"
        });




        //create the map
        var map = L.map('map', {
            center: new L.LatLng(44, -91),
            zoom: 7,
            layers: [OSM]
        });








function forEachFeature_district(feature, layer) {
        var popupContent = "<p> <b>" + feature.properties.location +
            "</b></br>Class: "+ feature.properties.class +"</p>";
        layer.bindPopup(popupContent);
    }


function forEachFeature_rank(feature, layer) {
        var popupContent = "<p> <b>" + feature.properties.headSchool +
            "</b></br>Week 0: "+ feature.properties.ranking0 +
            "</b></br>Week 1: "+ feature.properties.ranking1 +
            "</b></br>Week 2: "+ feature.properties.ranking2 +
            "</b></br>Week 3: "+ feature.properties.ranking3 +
            "</b></br>Week 4: "+ feature.properties.ranking4 +
            "</b></br>Week 5: "+ feature.properties.ranking5 +
            "</b></br>Week 6: "+ feature.properties.ranking6 +
            "</b></br>Week 7: "+ feature.properties.ranking7 +
            "</b></br>Week 8: "+ feature.properties.ranking8 +"</p>";
        layer.bindPopup(popupContent);
}





function getColor(d) {
	return d > 1000 ? '#800026' :
	       d > 500  ? '#BD0026' :
	       d > 200  ? '#E31A1C' :
	       d > 100  ? '#FC4E2A' :
	       d > 50   ? '#FD8D3C' :
	       d > 20   ? '#FEB24C' :
	       d > 10   ? '#FED976' :
	                  '#FFEDA0';
}








var districtMarkerOptions = {
    radius: 5,
    fillColor: "blue",
    color: "#000",
    weight: 1,
    opacity: 1,
    fillOpacity: 0.8
};




var rankingMarkerOptions = {
    radius: 6,
    //fillColor: getColor(feature.properties.ranking1),
    color: "#000",
    weight: 1,
    opacity: 1,
    fillOpacity: 0.8
};






var districtMeets = new L.GeoJSON.AJAX("https://profseeger.github.io/XC-rData/districtSites2019.geojson", {
	onEachFeature: forEachFeature_district,
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, districtMarkerOptions);
    }
}).addTo(map);




var rankedSchools  = new L.GeoJSON.AJAX("https://profseeger.github.io/XC-rData/schoolRankings.geojson", {
	onEachFeature: forEachFeature_rank,
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, rankingMarkerOptions);
    }
}).addTo(map);















        //layer control
        var baseMaps = {
            "OpenStreetMap": OSM,
            "ESRI Aerial": Esri_WorldImagery
        };

        var overlayMaps = {
            "Radar": nexrad,
            "District Sites": districtMeets,
             "Ranked Schools": rankedSchools

        };

        L.control.layers(baseMaps, overlayMaps).addTo(map);



        map.fitBounds(rankedSchools .getBounds(), {padding: [12, 12]});



    </script>

</body>
</html>

